import os, os.path, platform
import ctypes
import ctypes.util
import numpy as nu
from numpy.ctypeslib import ndpointer
import numpy as np

cmd_folder = os.path.abspath(os.path.split(inspect.getfile( inspect.currentframe() ))[0])
_lib = load_library('_d_hankel_t',cmd_folder)


c_compute_dht = _lib.compute_dht

def compute_dht ( size , indata , order , rmax ):
	outdata = np.zeros ( size , dtype = np.double )
	c_compute_dht ( ctypes.c_int ( size ) , ctypes.c_void_p ( indata.ctypes.data ) , ctypes.c_void_p ( outdata.ctypes.data ) , ctypes.c_int ( order ) , ctypes.c_double ( rmax ) )
	return outdata
	
if __name__ == '__main__' :
	import matplotlib.pyplot as py
	inarray = [895.288905316, 810.718191668, 696.290406069, 570.215383338, 399.498622809, 212.41319929, 128.460230838, 43.1929742175, 9.52052399383, 21.372440338, 46.6173684523, 85.8714739316, 116.359307726, 135.897669575, 124.384396317, 104.66272445, 86.2098602185, 52.8424754644, 29.5716880664, 20.3602336404, 18.6253614391, 28.9907805226, 38.760736791, 46.1210980983, 54.1109979088, 53.1091848218, 47.6376528364, 39.2538938911, 30.4300323063, 22.4763288759, 17.8039947025, 17.6671946222, 18.6698095908, 20.839600764, 22.4184594239, 24.9599164999, 23.6886122811, 22.4826237768, 21.6384744861, 19.5017323998, 16.6494725296, 16.9752420177, 16.5940391361, 14.063868004, 12.9920184835, 12.4163532428, 10.6841440869, 10.2789502573, 9.91279328128, 10.5832552196, 11.6199168516, 11.9056029283, 13.9584747289, 13.1351743982, 11.5250750135, 10.6748572979, 8.23126449731, 5.90779452541, 4.72906930012, 4.10243838537, 5.01007080548, 5.77428805505, 8.26378127656, 9.67281356501, 8.86800757861, 10.5679066865, 9.99110185443, 6.77818921286, 5.42629236428, 3.56850495789, 2.82298183269, 2.76307065961, 3.15015094193, 3.402836832, 3.7548153408, 3.66790661503, 3.30415813584, 2.95570449402, 2.2160283904, 1.85154928745, 1.29169467835, 1.1133212071, 1.14595811375, 1.25684990056, 1.69499380454, 2.09114847828, 2.19854678032, 2.35100107853, 2.09841769924, 1.64964800332, 1.225585561, 0.719427727841, 0.455310078078, 0.496670779741, 0.869930198115, 1.75000210636, 2.72061922898, 4.02955425305, 4.95007454261, 5.80667416654]
	p = compute_dht ( 100 , inarray , 1 , 35.178562364 )
	py.figure()
	py.imshow(p)
	py.show()  
	
